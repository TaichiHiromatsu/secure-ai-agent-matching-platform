# Trusted Agent Hub (Python/FastAPI Edition)

**Trusted Agent Hub** ã¯ã€AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ç™»éŒ²ãƒ»å¯©æŸ»ãƒ»å…¬é–‹ã‚’è¡Œã†ãŸã‚ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚
æœ¬ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ã€Python (FastAPI) + SQLite + Jinja2 ã‚’ä½¿ç”¨ã—ãŸå˜ä¸€ã‚³ãƒ³ãƒ†ãƒŠæ§‹æˆã«ãƒªãƒ©ã‚¤ãƒˆã•ã‚Œã¾ã—ãŸã€‚

## ğŸš€ ç‰¹å¾´

- **å˜ä¸€ã‚³ãƒ³ãƒ†ãƒŠ**: APIã€UIã€Workerã€DBã‚’1ã¤ã®Dockerã‚³ãƒ³ãƒ†ãƒŠã«é›†ç´„ã€‚ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ç®¡ç†ãŒå®¹æ˜“ã§ã™ã€‚
- **Pythonãƒã‚¤ãƒ†ã‚£ãƒ–**: å…¨ã¦ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’Pythonã§è¨˜è¿°ã€‚å‹ãƒ’ãƒ³ãƒˆã¨Pydanticã«ã‚ˆã‚‹å …ç‰¢ãªè¨­è¨ˆã€‚
- **åŸ‹ã‚è¾¼ã¿DB**: SQLiteã‚’ä½¿ç”¨ã—ã€å¤–éƒ¨DBã‚µãƒ¼ãƒãƒ¼ã¸ã®ä¾å­˜ã‚’æ’é™¤ï¼ˆPoCå‘ã‘ï¼‰ã€‚
- **ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°**: Jinja2ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ãŸé«˜é€ŸãªUIæç”»ã€‚

## ğŸ› ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
trusted_agent_hub/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py         # FastAPI ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ models.py       # SQLAlchemy ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ schemas.py      # Pydantic ã‚¹ã‚­ãƒ¼ãƒ
â”‚   â”œâ”€â”€ routers/        # API ãƒ«ãƒ¼ã‚¿ãƒ¼ (Submissions, Reviews, UI)
â”‚   â””â”€â”€ templates/      # Jinja2 HTML ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”œâ”€â”€ sandbox-runner/     # ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå¯©æŸ»ã‚¨ãƒ³ã‚¸ãƒ³ (Functional & Securityè©•ä¾¡)
â”œâ”€â”€ inspect-worker/     # Judge Panel (Agents-as-a-Judge: GPT-4o/Claude/Gemini)
â”œâ”€â”€ third_party/
â”‚   â””â”€â”€ aisev/          # AISI Security ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ
â”œâ”€â”€ static/             # é™çš„ãƒ•ã‚¡ã‚¤ãƒ« (CSS, JS)
â”œâ”€â”€ Dockerfile          # Docker ã‚¤ãƒ¡ãƒ¼ã‚¸å®šç¾©
â””â”€â”€ requirements.txt    # Python ä¾å­˜é–¢ä¿‚
```

## ğŸ“¦ èµ·å‹•æ–¹æ³•

### 1. ãƒ“ãƒ«ãƒ‰ & èµ·å‹•

```bash
cd trusted_agent_hub
docker build -t trusted-agent-hub .
docker run -p 8080:8080 trusted-agent-hub
```

### 2. ã‚¢ã‚¯ã‚»ã‚¹

- **ãƒ›ãƒ¼ãƒ **: http://localhost:8080
- **ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæå‡º**: http://localhost:8080/submit
- **ç®¡ç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**: http://localhost:8080/admin

## ğŸ§ª å¯©æŸ»ãƒ•ãƒ­ãƒ¼

### æå‡ºæ–¹æ³•

1.  **æå‡º (Submission)**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒAgent Card URLã‚’æå‡ºã—ã¾ã™ã€‚

    **æå‡ºUI**: `http://localhost:8080/submit`

    **å…¥åŠ›é …ç›®**:
    - **Agent Card URL**: A2A Protocolæº–æ‹ ã®Agent Card JSONã®URL
      - ã‚µãƒ³ãƒ—ãƒ«ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å ´åˆ: `http://sample-agent:4000/agent-card.json`
      - **å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**: `agentId`, `serviceUrl`, `translations`

    **ã‚³ãƒ³ãƒ†ãƒŠæƒ…å ±**:
    - **ã‚³ãƒ³ãƒ†ãƒŠå**: `trusted-agent-hub`
    - **ãƒãƒ¼ãƒˆ**: `8080:8080`
    - **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯**: `agent-hub_agent-hub-network`
    - **æ³¨æ„**: `sample-agent` ã¨é€šä¿¡ã™ã‚‹ãŸã‚ã€åŒã˜ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™

    **Agent Cardä»•æ§˜ (A2A Protocol)**:
    - `agentId`: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ä¸€æ„è­˜åˆ¥å­ï¼ˆè‡ªå‹•æŠ½å‡ºï¼‰
    - `serviceUrl`: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ã®å¯¾è©±ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆä¾‹: `http://sample-agent:4000/agent/chat`ï¼‰
    - `translations[0].displayName`: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®è¡¨ç¤ºå
    - `translations[0].shortDescription`: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®çŸ­ã„èª¬æ˜
    - `skills`: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒæä¾›ã™ã‚‹ã‚¹ã‚­ãƒ«ä¸€è¦§
    - `capabilities`: ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã€é€šçŸ¥ãªã©ã®æ©Ÿèƒ½ãƒ•ãƒ©ã‚°

2.  **è‡ªå‹•å¯©æŸ» (Automated Review)**: ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ãƒ¯ãƒ¼ã‚«ãƒ¼ãŒè‡ªå‹•çš„ã«ä»¥ä¸‹ã®ã‚¹ã‚³ã‚¢ã‚’ç®—å‡ºã—ã¾ã™ã€‚
    - **Security Score**: `sandbox-runner` ã‚’ä½¿ç”¨ã—ãŸå®Ÿéš›ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ”»æ’ƒãƒ†ã‚¹ãƒˆï¼ˆAdvBench/AISIï¼‰
    - **Functional Score**: Agent Cardã® `skills` ã«åŸºã¥ãæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
    - **Judge Panel Score**: Agents-as-a-Judgeæ–¹å¼ã«ã‚ˆã‚‹å¤šæ®µéšè©•ä¾¡
      - **AISI InspectåŸºæº–**: Task Completion (0-40), Tool Usage (0-30), Autonomy (0-20), Safety (0-10)
      - **Multi-Model Judge**: GPT-4o, Claude 3.5 Sonnet, Gemini 2.5 Flash ã«ã‚ˆã‚‹è©•ä¾¡ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«
      - **3æ®µéšæ¨è«–**: Plan â†’ Counter â†’ Reconcile ãƒ•ã‚§ãƒ¼ã‚ºã§è©•ä¾¡ã®ç²¾åº¦å‘ä¸Š
    - **Trust Score**: ä¸Šè¨˜ã‚¹ã‚³ã‚¢ã®çµ±åˆå€¤

    **å¯©æŸ»ãƒ—ãƒ­ã‚»ã‚¹**:
    - Agent Cardã‹ã‚‰ `serviceUrl` ã‚’æŠ½å‡ºã—ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«æ¥ç¶š
    - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚²ãƒ¼ãƒˆ: AISI Securityãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ (third_party/aisev) ã‹ã‚‰QAå–å¾—ã—ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå¿œç­”ã‚’è©•ä¾¡
    - æ©Ÿèƒ½ãƒã‚§ãƒƒã‚¯: ã‚¹ã‚­ãƒ«ã”ã¨ã«ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªã‚’å®Ÿè¡Œ
    - Judge Panel: å®Ÿè¡Œãƒ­ã‚°ã‚’Google ADK & Anthropic Computer UseçµŒç”±ã§å¯©æŸ»
    - ã‚¹ã‚³ã‚¢ã«åŸºã¥ãè‡ªå‹•åˆ¤å®šï¼ˆæ‰¿èª/æ‹’å¦/è¦äººé–“ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰ã‚’å®Ÿæ–½

3.  **åˆ¤å®š (Decision)**:
    - ã‚¹ã‚³ã‚¢ãŒä½ã„å ´åˆ: **è‡ªå‹•æ‹’å¦ (Auto Rejected)**
    - ã‚¹ã‚³ã‚¢ãŒé«˜ã„å ´åˆ: **è¦äººé–“ãƒ¬ãƒ“ãƒ¥ãƒ¼ (Requires Human Review)**
4.  **äººé–“ãƒ¬ãƒ“ãƒ¥ãƒ¼ (Human Review)**: ç®¡ç†è€…ãŒãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰æ‰¿èª/æ‹’å¦ã‚’æœ€çµ‚æ±ºå®šã—ã¾ã™ã€‚

## ğŸ“‚ ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

- **`trusted_agent_hub/`**: ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆFastAPI + SQLiteï¼‰
  - `app/`: Web API & UI
  - `sandbox-runner/`: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå¯©æŸ»ã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆFunctional & Securityè©•ä¾¡ï¼‰
  - `inspect-worker/`: Judge Panelï¼ˆAgents-as-a-Judgeå®Ÿè£…ï¼‰
  - `third_party/aisev/`: AISI Securityãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ
- **`sample-agent/`**: ãƒ†ã‚¹ãƒˆç”¨ã‚µãƒ³ãƒ—ãƒ«ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
- **`docker-compose.yml`**: ã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š

## âš ï¸ æ³¨æ„äº‹é …

- æœ¬ç’°å¢ƒã¯PoCï¼ˆæ¦‚å¿µå®Ÿè¨¼ï¼‰ç”¨ã§ã™ã€‚
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯ã‚³ãƒ³ãƒ†ãƒŠå†…ã®SQLiteãƒ•ã‚¡ã‚¤ãƒ«(`agent_hub.db`)ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€ã‚³ãƒ³ãƒ†ãƒŠã‚’å‰Šé™¤ã™ã‚‹ã¨ãƒ‡ãƒ¼ã‚¿ã‚‚æ¶ˆãˆã¾ã™ã€‚æ°¸ç¶šåŒ–ãŒå¿…è¦ãªå ´åˆã¯ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’ãƒã‚¦ãƒ³ãƒˆã—ã¦ãã ã•ã„ã€‚
