<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registered Agents - Trusted Agent Hub</title>
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
        <div class="mb-6">
            <a href="{{ url_prefix }}/" class="text-indigo-600 hover:text-indigo-800">&larr; Back to Home</a>
        </div>

        <h1 class="text-4xl font-bold mb-4 text-indigo-600">Registered Agents</h1>
        <p class="text-gray-600 mb-8">Browse all agents that have passed the evaluation process.</p>

        {% if agents %}
        <div class="bg-white rounded-lg shadow overflow-hidden">
            <table class="min-w-full text-sm">
                <thead class="bg-gray-100 text-gray-700">
                    <tr>
                        <th class="px-4 py-3 text-left">Name</th>
                        <th class="px-4 py-3 text-left">Provider</th>
                        <th class="px-4 py-3 text-left">Status</th>
                        <th class="px-4 py-3 text-left">Trust Score</th>
                        <th class="px-4 py-3 text-left">Score Breakdown</th>
                        <th class="px-4 py-3 text-left">Use Cases</th>
                        <th class="px-4 py-3 text-left">Updated</th>
                    </tr>
                </thead>
                <tbody>
                    {% for agent in agents %}
                    <tr class="border-t hover:bg-gray-50">
                        <td class="px-4 py-3">
                            <div class="font-medium text-gray-900">{{ agent.name }}</div>
                            {% if agent.endpoint_url %}
                            <div class="text-xs text-gray-500 mt-1">
                                <a href="{{ agent.endpoint_url }}" target="_blank" class="hover:text-indigo-600">
                                    {{ agent.endpoint_url[:50] }}...
                                </a>
                            </div>
                            {% endif %}
                        </td>
                        <td class="px-4 py-3">
                            <span class="px-2 py-1 bg-gray-100 rounded text-xs">{{ agent.provider }}</span>
                        </td>
                        <td class="px-4 py-3">
                            <span class="px-2 py-1 rounded text-xs {% if agent.status == 'active' %}bg-green-100 text-green-800{% else %}bg-gray-100 text-gray-800{% endif %}">
                                {{ agent.status }}
                            </span>
                        </td>
                        <td class="px-4 py-3">
                            {% if agent.trust_score is not none %}
                            <div class="flex items-center gap-2">
                                <div class="relative w-16 h-16">
                                    <svg class="w-16 h-16 transform -rotate-90">
                                        <circle cx="32" cy="32" r="28" stroke="#e5e7eb" stroke-width="6" fill="none"/>
                                        <circle cx="32" cy="32" r="28"
                                                stroke="{% if agent.trust_score >= 80 %}#10b981{% elif agent.trust_score >= 60 %}#3b82f6{% else %}#f59e0b{% endif %}"
                                                stroke-width="6"
                                                fill="none"
                                                stroke-dasharray="{{ (agent.trust_score / 100 * 175.93) }} 175.93"
                                                stroke-linecap="round"/>
                                    </svg>
                                    <div class="absolute inset-0 flex items-center justify-center">
                                        <span class="font-bold text-sm {% if agent.trust_score >= 80 %}text-green-600{% elif agent.trust_score >= 60 %}text-blue-600{% else %}text-yellow-600{% endif %}">
                                            {{ agent.trust_score }}
                                        </span>
                                    </div>
                                </div>
                            </div>
                            {% else %}
                            <span class="text-xs text-gray-400">N/A</span>
                            {% endif %}
                        </td>
                        <td class="px-4 py-3">
                            {% if agent.trust_score is not none %}
                            <div class="space-y-1 text-xs">
                                <div class="flex items-center justify-between">
                                    <span class="text-gray-600">Security:</span>
                                    <span class="font-medium">{{ agent.security_score or 0 }} / 30</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-gray-600">Functional:</span>
                                    <span class="font-medium">{{ agent.functional_score or 0 }} / 40</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-gray-600">Judge:</span>
                                    <span class="font-medium">{{ agent.judge_score or 0 }} / 30</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-gray-600">Implementation:</span>
                                    <span class="font-medium">{{ agent.implementation_score or 0 }} / 10</span>
                                </div>
                            </div>
                            {% else %}
                            <span class="text-xs text-gray-400">N/A</span>
                            {% endif %}
                        </td>
                        <td class="px-4 py-3">
                            {% if agent.use_cases %}
                            <div class="flex flex-wrap gap-1">
                                {% for use_case in agent.use_cases[:3] %}
                                <span class="px-2 py-1 bg-indigo-100 text-indigo-800 rounded text-xs">{{ use_case }}</span>
                                {% endfor %}
                                {% if agent.use_cases|length > 3 %}
                                <span class="text-xs text-gray-500">+{{ agent.use_cases|length - 3 }} more</span>
                                {% endif %}
                            </div>
                            {% else %}
                            <span class="text-xs text-gray-400">None</span>
                            {% endif %}
                        </td>
                        <td class="px-4 py-3 text-xs text-gray-600">
                            {{ agent.updated_at or agent.created_at or 'Unknown' }}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="bg-white rounded-lg shadow p-8 text-center">
            <p class="text-gray-500">No registered agents yet.</p>
            <a href="{{ url_prefix }}/submit" class="mt-4 inline-block px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700">
                Submit Your First Agent
            </a>
        </div>
        {% endif %}
    </div>
</body>
</html>
